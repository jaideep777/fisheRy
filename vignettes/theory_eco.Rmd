---
title: 'Fisheries model theory: socioeconomic model'
author: "Jaideep Joshi"
date: "13 Jan 2024"
output:
  html_document: default
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = F, echo = F}
library(fisheRy)
library(tidyverse)
source("../tests/ref/parameters.cod.R")
source("../tests/ref/simulator.7.R")
```

Given the fisheries management parameters, i.e., the minimum size limit and the harvest proportion, the socioeconomic model calculates fishing mortality, the corresponding yield, and other socioeconomic outcomes such as employment and profit. 

## Fishing Mortality

For a given harvesting rate $h$ and minimum size limit $L_{50}$, fishing mortality rate is given by 

$$
F = -\log(1-h)\cdot \sigma(l_a),
$$
where $\sigma(l_a)$ is the fishing selectivity

$$
\sigma(l_a) = \frac{1}{1+e^{-s(l_a-L_{50})}},
$$

where the parameters are

Parameter          Description
------------------ ----------------------------------------------------
$s$                Slope of the fishing selectivity curve


## Effort dynamics

### Required fishing effort

The effort (in terms of vessel-days) required to achieve the desired harvest proportion (i.e., to realize the required fishing mortality) is given by

$$
E(F) = N_\text{rel}^b \cdot F \cdot \frac{1-e^{-(F+M)(1-b)}}{q(F+M)(1-b)},
$$

where $M$ is the average natural mortality rate of the fishable individuals,

$$
M = \frac{\sum_{a,l}{\mu(a,l_a)\cdot \sigma(l_a) w_l} }{\sum_{a,l}{ \sigma(l_a) w_l} },
$$
and $N_\text{rel}$ is the current fishable biomass $B(t,h,L_{50})$ of the fished population relative to the fishable biomass of an equivalent but unfished population measured at equilibrium,

$$
N_\text{rel} = \frac{B(t,h,L_{50})}{B(\infty,0,L_{50})}.
$$
The fishable biomass is defined as 

$$
B(t,h,L_{50}) = \sum_{a,l}{\sigma(l_a) w_l}
$$

### Employment at sea and realized effort

We assume that the employment required at sea (in terms of person-years) to achieve the required fishing effort scales linearly with the required effort,

$$
D_\text{sea,req} = d_\text{sea} E
$$
However, it is often the case the with an increasing effort, not enough manpower can be hired, and thus, employment saturates at a maximum value of $D_\text{max}$. In such as case, the realized employment for a given amount of required effort is given by

$$
D_\text{sea,real} = \frac{D_\text{sea,req}}{1 + \frac{D_\text{sea,req}}{D_\text{max}}}
$$

Therefore, the realized effort is then,

$$
E_\text{real} = D_\text{sea,real} / d_\text{sea}.
$$
The realized fishing mortality corresponding to this effort can then be calculated by iteratively solving

$$
F_\text{real} = \text{root}( E(F) = E_\text{real}).
$$

### Spawing and feeding grounds fisheries

We assume that a fraction $f_s$ of the total harvest comes from spawning grounds. Furthermore, if $h_s$ is the harvest proportion in the spawning grounds, then

$$
f_s = \frac{h_s S}{h B}
$$

where $S$ is the fishable spawning stock biomass (biomass that can be harvested from the spawning grounds), whereas $B$ is the total fishable biomass. Thus,

$$
h_s = \frac{f_s h B}{S}
$$
If the harvest proportion in the feeding grounds is $h_f$, then the total harvest from feeding grounds is 

$$
h_f B = h B - h_s S,
$$

giving 

$$
h_f = h- h_s S/B
$$

We use $h_s$ and $h_f$ to compute $N_\text{rel,f}$ and $N_\text{rel,s}$ in the feeding and spawning grounds respectively, and calculate the total required effort as 

$$
E = E_f + E_s
$$

## Yield

Given the realized fishing mortality, yield is obtained from the Baranov Catch Equation,

$$
Y = \sum_{a,l_a} \frac{F_\text{real}}{F_\text{real} + \mu(a,l_a)} w_l.
$$

## Employment on shore

Employment on shore is proportional to the yield,

$$
D_\text{shore} = d_{shr} Y
$$

## Profit

Profit at sea is given by

$$
R_\text{sea}= Y P_\text{sea} - \gamma (D_\text{sea,req}S_\text{sea} + E_\text{req}C_\text{var,sea} + C_\text{fixed,sea})
$$

Profit on shore is given by

$$
R_\text{shr}= Y\cdot(P_\text{shr}-P_\text{sea}) - D_\text{shore} S_\text{shr} -  C_\text{fixed,shr}
$$

JAIDEEP: Why D_sea_req and not D_sea_real? When calculating employmwnt, should use req or real?