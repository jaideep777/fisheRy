<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fisheRy">
<title>Fisheries model theory: biological model • fisheRy</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fisheries model theory: biological model">
<meta property="og:description" content="fisheRy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fisheRy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--theory">
    <span class="fa fa-pencil fa-lg"></span>
     
    Theory
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--theory">
    <a class="dropdown-item" href="../articles/theory_bio.html">
      <span class="fa fa-fish"></span>
       
      Biological model
    </a>
    <a class="dropdown-item" href="../articles/theory_eco.html">
      <span class="fa fa-fish"></span>
       
      Socioeconomic model
    </a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--tutorials">
    <span class="fa fa-book fa-lg"></span>
     
    Tutorials
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--tutorials">
    <a class="dropdown-item" href="../articles/unfished_population.html">
      <span class="fa fa-fish"></span>
       
      Simulating an unfished population
    </a>
    <a class="dropdown-item" href="../articles/evolving_unfished_population.html">
      <span class="fa fa-fish"></span>
       
      Simulating an unfished fished population with evolution
    </a>
    <a class="dropdown-item" href="../articles/fished_population.html">
      <span class="fa fa-fish"></span>
       
      Simulating a fished population (biological model only)
    </a>
    <a class="dropdown-item" href="../articles/compare_hscans.html">
      <span class="fa fa-fish"></span>
       
      Simulating multiple populations at once
    </a>
    <a class="dropdown-item" href="../articles/jss_calcs_h.html">
      <span class="fa fa-fish"></span>
       
      Calculating JSS
    </a>
    <a class="dropdown-item" href="../articles/jss_calcs_hxL_evol.html">
      <span class="fa fa-fish"></span>
       
      Calculating 2D JSS with evolution
    </a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../html/index.html">
    <span class="fa fa-code fa-lg"></span>
     
    API
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/news.html">
    <span class="fa fa-newspaper fa-lg"></span>
     
    News
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://jaideep777.github.io/fisheRy">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fisheries model theory: biological model</h1>
                        <h4 data-toc-skip class="author">Jaideep Joshi,
Anna Shchiptsova</h4>
            
            <h4 data-toc-skip class="date">28 March 2022</h4>
      
      
      <div class="d-none name"><code>theory_bio.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A fish goes through four life-history processes every year:</p>
<ol style="list-style-type: decimal">
<li><p>Growth - This is the increment in the body size by growth. Growth
rates are different for mature and immature individuals, since mature
individuals allocate resources for reproduction.</p></li>
<li><p>Decision to mature - Every year, fish will decide whether or not
to mature (until maturation). Once matured, reproduction
begins.</p></li>
<li><p>Reproduction - production of eggs</p></li>
<li><p>Mortality - This is natural and fishing-induced death</p></li>
</ol>
<p>A fish is characterized by its age <span class="math inline">\(a \in
\{1,a_{\max}\}\)</span> and length <span class="math inline">\(l\)</span>, where <span class="math inline">\(a_{\max}\)</span> is the maximum considered age.
Below, we present our model formulations for these four life-history
processes. For comparison, we also present corresponding formulations
from a simpler age-structured model as in Dankel et al. XXXX.</p>
</div>
<div class="section level2">
<h2 id="growth">Growth<a class="anchor" aria-label="anchor" href="#growth"></a>
</h2>
<p>Let us define a generalized length increment (<span class="math inline">\(\Delta l_p\)</span>) from age <span class="math inline">\(a-1\)</span> to age <span class="math inline">\(a\)</span> as</p>
<p><span class="math display">\[
\Delta l_p = l_a^{\gamma_1 \gamma_2} - l_{a-1}^{\gamma_1 \gamma_2},
\]</span></p>
<p>where <span class="math inline">\(\gamma_{1}\)</span> is the
allometric exponent of relationship between energy-acquisition rate and
body weight, and <span class="math inline">\(\gamma_{2}\)</span> is the
allometric exponent of length-weight relationship.</p>
<p>In our model, growth depends on the fish’s length, temperature, the
total stock biomass of the population, such that the geneneralized
length increment is given by</p>
<p><span class="math display">\[
\Delta l_p = \gamma_{1}\alpha_{1}\alpha_{2}^{- \gamma_{1}}
e^{(\beta_1\Delta B +\beta_2 \Delta T)},
\]</span> where <span class="math inline">\(\alpha_{1}\)</span> is the
mean weight-specific energy-acquisition rate, <span class="math inline">\(\alpha_{2}\)</span> is the allometric coefficient
of the length-weight relationship, and <span class="math inline">\(\Delta B = B - \bar B\)</span> and <span class="math inline">\(\Delta T = T - \bar T\)</span> are the anomalies
of total stock biomass (TSB) and temperature, respectively. Setting
<span class="math inline">\(\beta_1 = \beta_2 = 0\)</span> removes the
temperature and density effects on growth.</p>
<p>In the absence of reproductive investment, i.e., for juvenile fish,
the new length is therefore</p>
<p><span class="math display">\[
l'_{a} = \left(l_{a - 1}^{\gamma_{1}\gamma_{2}} + \Delta
l_p\right)^{\frac{1}{{\gamma_{1}\gamma_{2}}}}
\]</span></p>
<p>Mature fish (adults) invest energy into reproduction, such that the
new length is downregulated. Thus, the length increment is</p>
<p><span class="math display">\[
l_{a} = \left\{
\begin{matrix}          
  l'_{a}, &amp; \mathrm{\text{if juvenile}}, \\   
  \text{max}\left\{\frac{l'_{a}}{(1 +
\gamma_{1}g)^{\frac{1}{{\gamma_{1}\gamma_{2}}}}},\ l_{a-1}\right\}
&amp;  \mathrm{\text{if adult}} \\
\end{matrix}
\right.\
\]</span><br>
where <span class="math inline">\(g\)</span> is the gonadosomatic index
(GSI), i.e., the ratio of reproductive investment and somatic weight for
mature individuals.</p>
<p>Symbols are summarized in the table below:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\gamma_{1}\)</span></td>
<td align="left">allometric exponent of relationship between
energy-acquisition rate and body weight</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\gamma_{2}\)</span></td>
<td align="left">allometric exponent of length-weight relationship</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha_{1}\)</span></td>
<td align="left">mean weight-specific energy-acquisition rate</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\alpha_{2}\)</span></td>
<td align="left">allometric coefficient of length-weight
relationship</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(g\)</span></td>
<td align="left">gonadosomatic index (ratio of reproductive investment
and somatic weight for mature individuals)</td>
</tr>
</tbody>
</table>
<p>We use the maximum of current and new length for adults to ensure
that body size does not shrink.</p>
<p>The effective GSI of the fish during this growth year can be
calculated from the difference between the potential length increment
and the realized length increment,</p>
<p><span class="math display">\[
g_{a}^{'} = \frac{ \Delta l_p - (l_{a}^{\gamma_{1}\gamma_{2}} - l_{a
- 1}^{\gamma_{1}\gamma_{2}})}{\gamma_{1}l_{a}^{\gamma_{1}\gamma_{2}}}.
\]</span></p>
<div class="section level3">
<h3 id="simulating-growth">Simulating growth<a class="anchor" aria-label="anchor" href="#simulating-growth"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params_file</span> <span class="op">=</span> <span class="st">"../params/cod_params.ini"</span></span></code></pre></div>
<p>Let us now simulate the growth of a fish starting at age 1 upto age
30 under constant temperature and TSB. The fish will perform maturation,
growth, and age increment, every year in that order. We will record the
fish length at each timestep so that we can plot the growth
trajectory.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">Fish</span>, <span class="va">params_file</span><span class="op">)</span></span>
<span><span class="va">fish</span><span class="op">$</span><span class="fu">init</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5.61</span><span class="op">)</span></span>
<span></span>
<span><span class="va">years</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">31</span></span>
<span><span class="va">length</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">31</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">years</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">length</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">fish</span><span class="op">$</span><span class="va">length</span></span>
<span>  <span class="va">fish</span><span class="op">$</span><span class="fu">updateMaturity</span><span class="op">(</span><span class="fl">5.61</span><span class="op">)</span></span>
<span>  <span class="va">fish</span><span class="op">$</span><span class="fu">grow</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5.61</span><span class="op">)</span></span>
<span>  <span class="va">fish</span><span class="op">$</span><span class="fu">set_age</span><span class="op">(</span><span class="va">fish</span><span class="op">$</span><span class="va">age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">length</span><span class="op">~</span><span class="va">years</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab<span class="op">=</span><span class="st">"Length"</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Now, since the growth trajectory of a fish depends on the age at
which it matures, and since maturation is a random process, let us
simulate lots of fish and look at the possible growth trajectories.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">growth_trajectories</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta1</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">beta2</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">N</span><span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t_birth"</span>,  <span class="st">"age"</span>,  <span class="st">"isMature"</span>, <span class="st">"isAlive"</span>,  <span class="st">"length"</span>,   <span class="st">"weight"</span>, <span class="st">"mort"</span>, <span class="st">"temp"</span>, <span class="st">"fec"</span>, <span class="st">"ssb"</span><span class="op">)</span></span>
<span>  <span class="va">dat_full</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fl">0</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_full</span><span class="op">)</span> <span class="op">=</span> <span class="va">names</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span>, y<span class="op">=</span><span class="cn">NA</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">31</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">250</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, ylab <span class="op">=</span> <span class="st">"Length"</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">fish</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">Fish</span>, <span class="va">params_file</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">beta1</span><span class="op">)</span><span class="op">)</span> <span class="va">fish</span><span class="op">$</span><span class="va">par</span><span class="op">$</span><span class="va">beta1</span> <span class="op">=</span> <span class="va">beta1</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">beta2</span><span class="op">)</span><span class="op">)</span> <span class="va">fish</span><span class="op">$</span><span class="va">par</span><span class="op">$</span><span class="va">beta2</span> <span class="op">=</span> <span class="va">beta2</span></span>
<span>  </span>
<span>    <span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fl">0</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">=</span> <span class="va">names</span></span>
<span>  </span>
<span>    <span class="va">temp0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean<span class="op">=</span><span class="fl">5.61</span>, sd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="va">tsb0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1.93e3</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="va">fish</span><span class="op">$</span><span class="fu">init</span><span class="op">(</span><span class="va">tsb0</span>, <span class="va">temp0</span><span class="op">)</span></span>
<span>    <span class="va">dat</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fish</span><span class="op">$</span><span class="fu">get_state</span><span class="op">(</span><span class="op">)</span>, <span class="va">fish</span><span class="op">$</span><span class="fu">naturalMortalityRate</span><span class="op">(</span><span class="fl">5.61</span><span class="op">)</span>, <span class="fl">5.61</span>, <span class="fl">0</span>, <span class="fl">0.8</span><span class="op">*</span><span class="va">tsb0</span><span class="op">)</span> <span class="co"># Assuming SSB is 80% of TSB, since we are not simulating a population</span></span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean<span class="op">=</span><span class="fl">5.61</span>, sd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>      <span class="va">tsb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1.93e3</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span>      <span class="va">fish</span><span class="op">$</span><span class="fu">updateMaturity</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span>      <span class="va">fish</span><span class="op">$</span><span class="fu">grow</span><span class="op">(</span><span class="va">tsb</span>, <span class="va">temp</span><span class="op">)</span></span>
<span>      <span class="va">fish</span><span class="op">$</span><span class="fu">set_age</span><span class="op">(</span><span class="va">fish</span><span class="op">$</span><span class="va">age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="va">dat</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fish</span><span class="op">$</span><span class="fu">get_state</span><span class="op">(</span><span class="op">)</span>, <span class="va">fish</span><span class="op">$</span><span class="fu">naturalMortalityRate</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span>, <span class="va">temp</span>, <span class="va">fish</span><span class="op">$</span><span class="fu">produceRecruits</span><span class="op">(</span><span class="fl">0.8</span><span class="op">*</span><span class="va">tsb</span><span class="op">*</span><span class="fl">1e6</span>, <span class="va">temp</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">*</span><span class="va">tsb</span><span class="op">)</span> <span class="co"># Assuming SSB is 80% of TSB, since we are not simulating a population</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">length</span><span class="op">~</span><span class="va">dat</span><span class="op">$</span><span class="va">age</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">[</span><span class="va">f</span><span class="op">]</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">dat_full</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat_full</span>, <span class="va">dat</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">dat_full</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_full</span> <span class="op">=</span> <span class="fu">growth_trajectories</span><span class="op">(</span>N<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="decision-to-mature">Decision to mature<a class="anchor" aria-label="anchor" href="#decision-to-mature"></a>
</h2>
<p>Decision to mature is defined by a probabilistic maturation reaction
norm (PMRN), with a probability of maturing in the next year depending
on age <span class="math inline">\(a\)</span>, length <span class="math inline">\(l\)</span>, and temperature <span class="math inline">\(T\)</span>, given by the following equation,</p>
<p><span class="math display">\[
m(a,l_a,T) = \frac{1}{1 + e^{-\left(\frac{l_{a} - (s_{m}a +
i_{m})}{d_{m}} + \beta_3 \Delta T\right)}},
\]</span></p>
<p>with the steepness of the curve <span class="math inline">\(d_m\)</span> calculated as</p>
<p><span class="math display">\[
d_{m} = \frac{\Delta l_{50}}{\ln{\left( \frac{1 - p}{p} \right) -
\ln\left( \frac{p}{1 - p} \right)}}.
\]</span></p>
<p>Let us visualize the PMRN.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lvec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">avec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">31</span>, length.out <span class="op">=</span> <span class="fl">31</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fish</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="va">Fish</span>, <span class="va">params_file</span><span class="op">)</span></span>
<span><span class="va">fish</span><span class="op">$</span><span class="fu">init</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5.61</span><span class="op">)</span></span>
<span></span>
<span><span class="va">calc_maturation_prob1</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>,<span class="va">l</span>, <span class="va">temp</span><span class="op">=</span><span class="fl">5.61</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fish</span><span class="op">$</span><span class="fu">set_age</span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>  <span class="va">fish</span><span class="op">$</span><span class="fu">set_length</span><span class="op">(</span><span class="va">l</span><span class="op">)</span></span>
<span>  <span class="va">p</span> <span class="op">=</span> <span class="va">fish</span><span class="op">$</span><span class="fu">maturationProb</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span>  <span class="va">p</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, avec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">31</span>, length.out <span class="op">=</span> <span class="fl">31</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">cross_df</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>prob <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_dbl</a></span><span class="op">(</span><span class="va">avec</span>, <span class="va">lvec</span>, <span class="op">~</span><span class="fu">calc_maturation_prob1</span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_raster</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">avec</span>, y<span class="op">=</span><span class="va">lvec</span>, fill<span class="op">=</span><span class="va">prob</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Age"</span>, y<span class="op">=</span><span class="st">"Length"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_classic</span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `cross_df()` was deprecated in purrr 1.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `tidyr::expand_grid()` instead.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> See &lt;https://github.com/tidyverse/purrr/issues/768&gt;.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.61</span>,<span class="fl">5.61</span>,<span class="fl">6.61</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">cross_df</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>prob <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_dbl</a></span><span class="op">(</span><span class="va">lvec</span>, <span class="va">temp</span>, <span class="op">~</span><span class="fu">calc_maturation_prob1</span><span class="op">(</span>a<span class="op">=</span><span class="fl">10</span>, l<span class="op">=</span><span class="va">.x</span>, temp <span class="op">=</span> <span class="va">.y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">lvec</span>, y<span class="op">=</span><span class="va">prob</span>, group<span class="op">=</span><span class="va">temp</span>, col<span class="op">=</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_colour_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Length"</span>, y<span class="op">=</span><span class="st">"Maturation probability"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_classic</span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>This PMRN influences the growth trajectories by determining the age
at maturation, like so,</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_full_00</span> <span class="op">=</span> <span class="fu">growth_trajectories</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>and leads to the following maturity ogives.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_full</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>maturity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">isMature</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maturity</span><span class="op">~</span><span class="va">age</span>, ylab<span class="op">=</span><span class="st">"Maturity"</span>, xlab<span class="op">=</span><span class="st">"Age"</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"cyan3"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_full</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>length_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">length</span>, breaks<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">length_class</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>maturity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">isMature</span><span class="op">)</span>, length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maturity</span><span class="op">~</span><span class="va">length</span>, ylab<span class="op">=</span><span class="st">"Maturity"</span>, xlab<span class="op">=</span><span class="st">"Length"</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"cyan3"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
<!-- ```{r} -->
<!-- dat_full %>% mutate(length_class = ave(length, cut(length, breaks=20)), temp_class = ave(temp, cut(temp, breaks=10))) %>% group_by(length_class, temp_class) %>% summarize(maturity = mean(isMature)) %>% ggplot() + geom_line(aes(y=maturity, x=length_class, group=temp_class, colour=temp_class))+scale_colour_viridis_c()+theme_classic(base_size = 20)+labs(x="Length", y="Maturity", colour="T") -->
<!-- ``` -->
<p>Parameters for maturation process are listed in the following
table:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\Delta l_{p}\)</span></td>
<td align="left">PMRN width (length range of maturation envelope)</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(p\)</span></td>
<td align="left">probability at lower bound of maturation envelope</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(s_{m}\)</span></td>
<td align="left">PMRN slope</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(i_{m}\)</span></td>
<td align="left">PMRN intercept</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="reproduction-and-recruitment">Reproduction and recruitment<a class="anchor" aria-label="anchor" href="#reproduction-and-recruitment"></a>
</h2>
<p>Cumulative reproductive investment translates into production of
eggs. The fecundity rate (number of eggs produced per year) is given by
the following equation:</p>
<p><span class="math display">\[
f(a,l_a) = \delta g_{a}^{'} \cdot w(l_a)
\]</span></p>
<p>where <span class="math inline">\(w(l_a)\)</span> is the weight of
the fish of length <span class="math inline">\(l_a\)</span>,</p>
<p><span class="math display">\[
w(l_a) =  \alpha_{2}l_{a}^{\gamma_{2}},
\]</span></p>
<p>and <span class="math inline">\(\delta\)</span> is the mass-specific
oocyte density of the mature pre-spawning ovary.</p>
<p>Eggs survive the first year with a probability <span class="math inline">\(s_0\)</span> to become recruits. Number of
recruits additionally also follows a temperature dependence with
parameter <span class="math inline">\(\beta_4\)</span> and a Ricker
density dependence with parameter <span class="math inline">\(B_{1/2}\)</span>,</p>
<p><span class="math display">\[
n_\text{recruits} = n_\text{eggs}\cdot s_0 \cdot e^{\beta_4 \Delta T}
\cdot 2^{-S/B_{1/2}},
\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the spawning stock
biomass of the population</p>
<p><span class="math display">\[
S = \sum_{\text{a &gt;= 3}} w_a I_\text{mature},
\]</span></p>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(s_0\)</span></td>
<td align="left">Maximum survival probability of offspring,</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(B_{1/2}\)</span></td>
<td align="left">SSB at which survival probability drops to half</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.61</span>, <span class="fl">5.61</span>, <span class="fl">6.61</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">cross_df</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.5135</span><span class="op">*</span><span class="op">(</span><span class="va">temp</span><span class="op">-</span><span class="fl">5.61</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">/</span><span class="fl">0.530</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>,x<span class="op">=</span><span class="va">x</span>, col<span class="op">=</span><span class="va">temp</span>, group<span class="op">=</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Spawning stock biomass (Mt)"</span>, y <span class="op">=</span> <span class="st">"Recruits / Recruits_0"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_colour_viridis_c</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Here is the number of recruits per fish as a function of spawning
stock biomass obtained from the growth trajectories above.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_full</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">ssb</span>, y<span class="op">=</span><span class="va">fec</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>col<span class="op">=</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_colour_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Spawning stock biomass (kT)"</span>, y <span class="op">=</span> <span class="st">"Recruits per capita"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_classic</span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_y_log10</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-4</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 28 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_full</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>ssb_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ave.html" class="external-link">ave</a></span><span class="op">(</span><span class="va">ssb</span>, <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ssb</span>, breaks <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">age</span>, <span class="va">ssb_class</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>recr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fec</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_tile</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span>, y<span class="op">=</span><span class="va">ssb_class</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">recr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">scale_fill_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"Spawning stock biomass (kT)"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_classic</span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'age'. You can override using the `.groups`</span></span>
<span><span class="co">## argument.</span></span></code></pre>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="mortality">Mortality<a class="anchor" aria-label="anchor" href="#mortality"></a>
</h2>
<p>We define the mortality rate of juvenile fish at reference
temperature <span class="math inline">\(T_\text{ref}\)</span> as</p>
<p><span class="math display">\[
M_\text{ref} = \mu_0 + \alpha_{3}\left( \frac{l_{a}}{l_{\text{ref}}}
\right)^{\gamma_{3}} +
\alpha_{4}\left(\alpha_1^2-\alpha_{1,\text{ref}}^2\right)
+  \alpha_{5}\left(g_a-g_{a,\text{ref}}\right)
\]</span></p>
<p>where parameters have the following meanings</p>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\mu_0\)</span></td>
<td align="left">Length independent intrinsic mortality rate</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\gamma_{3}\)</span></td>
<td align="left">Allometric exponent of relationship between
instantaneous natural mortality rate and body length</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha_{3}\)</span></td>
<td align="left">Instantaneous natural mortality rate at reference
length</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(l_{\text{ref}}\)</span></td>
<td align="left">Reference length for natural mortality</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha_{4}\)</span></td>
<td align="left">Coefficient of growth-dependent mortality rate</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\alpha_{1,\text{ref}}\)</span></td>
<td align="left">Reference length of growth-dependent mortality</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha_{5}\)</span></td>
<td align="left">Coefficient of GSI-dependent mortality rate</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(g_{a,\text{ref}}\)</span></td>
<td align="left">Reference GSI for GSI-dependent mortality</td>
</tr>
</tbody>
</table>
<p>The term <span class="math inline">\(\alpha_4 \alpha_1^2\)</span>
represents the additional mortality associated with greater energy
acquisition rates (encoding a growth-mortality tradeoff), resulting, for
e.g., from greater predation during foraging. Likewise, the term <span class="math inline">\(\alpha_5 g_a\)</span> represents additional
mortality related to overinvesting in reproduction, encoding a
reproduction-mortality tradeoff. Also, note that these terms essentially
guide evolution of life-history strategies, and disappear if traits are
fixed at their reference values.</p>
<p>Then, the juvenile and adult instantaneous natural mortality rate is
given by the following equation:</p>
<p><span class="math display">\[
M(a,l_a) = \left\{
\begin{matrix}          
  M_\text{ref}\left(\frac{T}{T_\text{ref}}\right)^{c_T}, &amp;
\mathrm{\text{if juvenile}}, \\   
  \left(\mu_s\left(\frac{l_0}{l_a}\right) + M_\text{ref}
\right)\left(\frac{T}{T_\text{ref}}\right)^{c_T},
&amp;  \mathrm{\text{if mature}} \\
\end{matrix}
\right.\
\]</span></p>
<p>where the coefficient <span class="math inline">\(\mu_s\)</span>
relates to the additional mortality experienced by mature fish in the
spawing grounds, and symbols have the following meanings</p>
<!-- QUESTION: Shouldn't we weigh the spawing and feeding grounds terms by the relative time spent in feeding and spawing grounds? -->
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(T_{\text{ref}}\)</span></td>
<td align="left">Reference temperature for natural mortality</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(c_T\)</span></td>
<td align="left">Exponent of the temperature dependence of
mortality</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\mu_s\)</span></td>
<td align="left">Mortality rate experienced by mature individuals in the
spawning grounds</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(l_0\)</span></td>
<td align="left">Body length at age 0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_full</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">mort</span>, x<span class="op">=</span><span class="va">length</span>, col<span class="op">=</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Length"</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Inst. natural mortality rate (yr"</span><span class="op">^</span><span class="st">"-1"</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"Temp"</span>, <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_c</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span>cols<span class="op">=</span><span class="fu">vars</span><span class="op">(</span><span class="va">isMature</span><span class="op">)</span>, labeller <span class="op">=</span> <span class="fu">as_labeller</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`0`<span class="op">=</span><span class="st">"Immature"</span>, `1`<span class="op">=</span><span class="st">"Mature"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 45 rows containing missing values (`geom_point()`).</span></span>
<span><span class="co">## Removed 45 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>Instantaneous fishing mortality rate depends on the harvest
proportion <span class="math inline">\(h\)</span> and fishing
selectivity <span class="math inline">\(\sigma\)</span>, and acts on top
of natural mortality. Thus, for a given harvest proportion <span class="math inline">\(h\)</span> and minimum size limit <span class="math inline">\(L_{50}\)</span>, fishing mortality rate is given
by</p>
<p><span class="math display">\[
F = -\log(1-h)\cdot \sigma(l_a),
\]</span></p>
<p>where <span class="math inline">\(\sigma(l_a)\)</span> is the fishing
selectivity,</p>
<p><span class="math display">\[
\sigma(l_a) = \frac{1}{1+e^{-s(l_a-L_{50})}},
\]</span></p>
<p>where <span class="math inline">\(s\)</span> is the Slope of the
fishing selectivity curve.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span>,length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>mort <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1222</span><span class="op">*</span><span class="op">(</span><span class="va">length</span><span class="op">-</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">mort</span>, x<span class="op">=</span><span class="va">length</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_line</span><span class="op">(</span>col<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Length"</span>, y<span class="op">=</span><span class="st">"Fishing selectivity"</span>, col<span class="op">=</span><span class="st">"Temp"</span><span class="op">)</span><span class="op">+</span><span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_full</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>sel <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1222</span><span class="op">*</span><span class="op">(</span><span class="va">length</span><span class="op">-</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">mort</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.4</span><span class="op">)</span><span class="op">*</span><span class="va">sel</span>, x<span class="op">=</span><span class="va">length</span>, col<span class="op">=</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_point</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Length"</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Inst. total mortality rate (yr"</span><span class="op">^</span><span class="st">"-1"</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"Temp"</span><span class="op">)</span><span class="op">+</span><span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">+</span><span class="fu">scale_color_viridis_c</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 45 rows containing missing values (`geom_point()`).</span></span>
<span><span class="co">## Removed 45 rows containing missing values (`geom_point()`).</span></span></code></pre>
<p><img src="theory_bio_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
<div class="section level3">
<h3 id="survival-probability">Survival probability<a class="anchor" aria-label="anchor" href="#survival-probability"></a>
</h3>
<p>Survival probability thus given by the following equation:</p>
<p><span class="math display">\[
s(a,l_a) = e^{- (M(a,l_a) + F)},
\]</span> where <span class="math inline">\(F\)</span> is the fishing
mortality rate.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://jaideep777.github.io" class="external-link">Jaideep Joshi</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
